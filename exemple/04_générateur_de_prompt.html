<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>G√©n√©rateur de Prompts IA - Prompt Engineering Avanc√©</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #334155 100%);
            color: #333;
            min-height: 100vh;
            padding: 20px;
            position: relative;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background:
                radial-gradient(600px circle at 20% 30%, rgba(14, 165, 233, 0.15), transparent 40%),
                radial-gradient(800px circle at 80% 20%, rgba(239, 68, 68, 0.15), transparent 40%),
                radial-gradient(600px circle at 40% 70%, rgba(34, 197, 94, 0.1), transparent 40%),
                radial-gradient(400px circle at 90% 90%, rgba(168, 85, 247, 0.15), transparent 40%);
            pointer-events: none;
            z-index: -1;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(20px);
            border-radius: 24px;
            padding: 40px;
            box-shadow:
                0 25px 50px -12px rgba(0, 0, 0, 0.25),
                0 0 0 1px rgba(255, 255, 255, 0.1),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .header {
            text-align: center;
            margin-bottom: 50px;
            padding: 50px 0;
            background: linear-gradient(135deg, #1e40af 0%, #3b82f6 25%, #06b6d4 50%, #10b981 75%, #f59e0b 100%);
            border-radius: 24px;
            color: white;
            position: relative;
            overflow: hidden;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background:
                radial-gradient(circle at 30% 20%, rgba(255, 255, 255, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 70% 80%, rgba(255, 255, 255, 0.05) 0%, transparent 50%);
            pointer-events: none;
        }

        h1 {
            font-size: 3.5em;
            font-weight: 900;
            margin: 0;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
            background: linear-gradient(45deg, #ffffff, #f1f5f9);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .subtitle {
            font-size: 1.4em;
            opacity: 0.95;
            margin-top: 15px;
            font-weight: 600;
            letter-spacing: 0.5px;
        }

        .api-status-section {
            background: linear-gradient(135deg, #dcfce7 0%, #bbf7d0 100%);
            border: 2px solid #22c55e;
            color: #15803d;
            padding: 25px;
            border-radius: 16px;
            margin: 30px 0;
            display: none;
            box-shadow: 0 4px 6px -1px rgba(34, 197, 94, 0.1);
        }

        .api-config-section {
            background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
            border: 2px solid #f59e0b;
            color: #92400e;
            padding: 30px;
            border-radius: 16px;
            margin: 30px 0;
            display: none;
            box-shadow: 0 4px 6px -1px rgba(245, 158, 11, 0.1);
        }

        .api-link {
            display: inline-block;
            background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%);
            color: white;
            padding: 12px 24px;
            border-radius: 50px;
            text-decoration: none;
            margin: 10px;
            font-weight: 700;
            transition: all 0.3s ease;
            box-shadow: 0 4px 6px -1px rgba(37, 99, 235, 0.2);
        }

        .api-link:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(37, 99, 235, 0.3);
            background: linear-gradient(135deg, #1d4ed8 0%, #1e40af 100%);
        }

        .api-key-input input {
            width: 100%;
            padding: 16px 20px;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            font-family: 'JetBrains Mono', 'Fira Code', monospace;
            font-size: 0.95em;
            background: rgba(255, 255, 255, 0.8);
            transition: all 0.3s ease;
        }

        .api-key-input input:focus {
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
            outline: none;
        }

        .api-key-input button {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 10px;
            cursor: pointer;
            margin-top: 15px;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .api-key-input button:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
        }

        .api-key-input .clear-btn {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            margin-left: 10px;
        }

        .api-key-input .clear-btn:hover {
            box-shadow: 0 4px 12px rgba(239, 68, 68, 0.3);
        }

        .generator-section {
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
            padding: 40px;
            border-radius: 20px;
            margin: 40px 0;
            border-left: 6px solid #3b82f6;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
            border: 1px solid rgba(59, 130, 246, 0.1);
        }

        .form-group {
            margin: 30px 0;
            transition: all 0.3s ease;
        }

        .form-group.hidden {
            opacity: 0;
            max-height: 0;
            overflow: hidden;
            margin: 0;
            transition: all 0.3s ease;
        }

        .form-group label {
            display: block;
            font-weight: 700;
            margin-bottom: 12px;
            color: #2c3e50;
            font-size: 1.1em;
        }

        .form-group select,
        .form-group textarea,
        .form-group input {
            width: 100%;
            padding: 16px 20px;
            border: 2px solid #e9ecef;
            border-radius: 12px;
            font-size: 1em;
            transition: all 0.3s ease;
            background: white;
            font-family: inherit;
        }

        .form-group select:focus,
        .form-group textarea:focus,
        .form-group input:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.1);
            transform: translateY(-2px);
        }

        .form-group textarea {
            min-height: 120px;
            resize: vertical;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
        }

        @media (max-width: 768px) {
            .form-row {
                grid-template-columns: 1fr;
            }
        }

        .profession-selection {
            background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%);
            padding: 30px;
            border-radius: 16px;
            margin: 25px 0;
            border-left: 5px solid #2563eb;
            box-shadow: 0 4px 6px -1px rgba(37, 99, 235, 0.1);
        }

        .recommended-frameworks {
            margin-top: 25px;
            padding: 25px;
            background: rgba(255, 255, 255, 0.8);
            border-radius: 12px;
            border: 2px solid #e5e7eb;
            backdrop-filter: blur(10px);
        }

        .framework-card {
            background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            padding: 20px;
            margin: 15px 0;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .framework-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(59, 130, 246, 0.1), transparent);
            transition: left 0.5s;
        }

        .framework-card:hover::before {
            left: 100%;
        }

        .framework-card:hover {
            border-color: #3b82f6;
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(59, 130, 246, 0.15);
        }

        .framework-card.selected {
            border-color: #10b981;
            background: linear-gradient(135deg, #ecfdf5 0%, #d1fae5 100%);
            box-shadow: 0 10px 25px rgba(16, 185, 129, 0.2);
        }

        .generate-btn {
            background: linear-gradient(135deg, #059669 0%, #047857 25%, #0891b2 50%, #0284c7 75%, #2563eb 100%);
            color: white;
            border: none;
            padding: 20px 50px;
            border-radius: 50px;
            font-size: 1.2em;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
            margin: 30px 0;
            text-transform: uppercase;
            letter-spacing: 1px;
            position: relative;
            overflow: hidden;
            box-shadow: 0 10px 25px rgba(37, 99, 235, 0.3);
        }

        .generate-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transition: left 0.5s;
        }

        .generate-btn:hover::before {
            left: 100%;
        }

        .generate-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 30px rgba(40, 167, 69, 0.4);
        }

        .generate-btn:disabled {
            background: #6c757d;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .framework-preview {
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
            padding: 25px;
            border-radius: 15px;
            margin: 20px 0;
            border-left: 5px solid #2196f3;
            display: none;
            animation: slideIn 0.3s ease;
        }

        .framework-preview.show {
            display: block;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .variable-inputs {
            display: none;
            margin: 25px 0;
            padding: 30px;
            background: linear-gradient(135deg, #fff 0%, #f8f9fa 100%);
            border-radius: 15px;
            border: 2px solid #dee2e6;
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.05);
        }

        .variable-inputs.show {
            display: block;
            animation: fadeInUp 0.4s ease;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .variable-input {
            margin: 20px 0;
        }

        .variable-input label {
            font-weight: 600;
            color: #495057;
            margin-bottom: 8px;
            display: block;
        }

        .variable-input input {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #ced4da;
            border-radius: 8px;
            font-size: 0.95em;
            transition: all 0.3s ease;
        }

        .variable-input input:focus {
            border-color: #ff6b6b;
            box-shadow: 0 0 0 3px rgba(255, 107, 107, 0.1);
        }

        .result-section {
            background: linear-gradient(135deg, #e8f5e8 0%, #c8e6c9 100%);
            padding: 40px;
            border-radius: 20px;
            margin: 40px 0;
            display: none;
            border-left: 6px solid #4caf50;
        }

        .result-section.show {
            display: block;
            animation: slideInUp 0.5s ease;
        }

        @keyframes slideInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .prompt-output {
            background: rgba(255, 255, 255, 0.95);
            padding: 30px;
            border-radius: 16px;
            border-left: 5px solid #2563eb;
            margin: 25px 0;
            font-family: 'JetBrains Mono', 'Fira Code', 'Monaco', monospace;
            white-space: pre-wrap;
            max-height: 500px;
            overflow-y: auto;
            line-height: 1.6;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
        }

        .action-buttons {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            margin: 20px 0;
        }

        .btn {
            background: linear-gradient(135deg, #0891b2 0%, #0284c7 100%);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 50px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 4px 6px -1px rgba(8, 145, 178, 0.2);
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(8, 145, 178, 0.3);
        }

        .btn.warning {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
            color: white;
            box-shadow: 0 4px 6px -1px rgba(245, 158, 11, 0.2);
        }

        .btn.warning:hover {
            box-shadow: 0 10px 25px rgba(245, 158, 11, 0.3);
        }

        .btn.success {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            box-shadow: 0 4px 6px -1px rgba(16, 185, 129, 0.2);
        }

        .btn.success:hover {
            box-shadow: 0 10px 25px rgba(16, 185, 129, 0.3);
        }

        .btn.primary {
            background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
            color: white;
            border: none;
        }

        .btn.primary:hover {
            background: linear-gradient(135deg, #2563eb 0%, #1e40af 100%);
            transform: translateY(-2px);
        }


        .status-indicator {
            padding: 12px 20px;
            border-radius: 50px;
            font-size: 0.95em;
            margin: 15px 0;
            display: inline-block;
            font-weight: 600;
        }

        .status-success {
            background: linear-gradient(135deg, #dcfce7 0%, #bbf7d0 100%);
            color: #15803d;
            border: 2px solid #22c55e;
        }

        .status-error {
            background: linear-gradient(135deg, #fecaca 0%, #fca5a5 100%);
            color: #dc2626;
            border: 2px solid #ef4444;
        }

        .status-loading {
            background: linear-gradient(135deg, #e5e7eb 0%, #d1d5db 100%);
            color: #374151;
            border: 2px solid #9ca3af;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {

            0%,
            100% {
                opacity: 1;
            }

            50% {
                opacity: 0.7;
            }
        }

        .back-to-module {
            text-align: center;
            margin: 50px 0;
        }

        .back-to-module .btn {
            margin: 8px;
            padding: 15px 30px;
            background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%);
        }

        .framework-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .stat-card {
            background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
            padding: 25px;
            border-radius: 16px;
            text-align: center;
            border: 2px solid #e5e7eb;
            transition: all 0.3s ease;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            border-color: #3b82f6;
        }

        .stat-number {
            font-size: 2.8em;
            font-weight: 900;
            background: linear-gradient(135deg, #2563eb 0%, #10b981 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
        }

        .warning-message {
            background: linear-gradient(135deg, #fef2f2 0%, #fecaca 100%);
            color: #dc2626;
            padding: 15px 20px;
            border-radius: 12px;
            margin: 15px 0;
            border-left: 4px solid #ef4444;
            font-weight: 600;
        }

        .tab-navigation {
            display: flex;
            background: rgba(248, 250, 252, 0.8);
            border-radius: 12px;
            padding: 6px;
            margin: 25px 0;
            backdrop-filter: blur(10px);
            border: 1px solid #e5e7eb;
        }

        .tab-btn {
            flex: 1;
            padding: 14px 24px;
            border: none;
            background: transparent;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            color: #64748b;
        }

        .tab-btn.active {
            background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%);
            color: white;
            box-shadow: 0 4px 6px -1px rgba(37, 99, 235, 0.3);
        }
        
        /* Styles pour la configuration Ollama */
        .ollama-config {
            background: #f8fafc;
            padding: 20px;
            border-radius: 12px;
            margin-top: 15px;
        }

        .ollama-config .form-group {
            margin-bottom: 15px;
        }

        .ollama-config label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: #334155;
        }

        .ollama-config input[type="text"],
        .ollama-config select {
            width: 100%;
            padding: 10px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s;
        }

        .ollama-config input[type="text"]:focus,
        .ollama-config select:focus {
            outline: none;
            border-color: #3b82f6;
        }

        #ollamaConfigButtons {
            margin-top: 15px;
            text-align: center;
        }

        #ollamaConfigButtons button {
            background: #3b82f6;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: background 0.3s;
        }

        #ollamaConfigButtons button:hover {
            background: #2563eb;
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="header">
            <h1>G√©n√©rateur de Prompts IA</h1>
            <div class="subtitle">Intelligence Artificielle ‚Ä¢ Prompt Engineering ‚Ä¢ Innovation</div>
        </div>

        <div class="framework-stats">
            <div class="stat-card">
                <div class="stat-number">21</div>
                <div>Frameworks Disponibles</div>
            </div>
            <div class="stat-card">
                <div class="stat-number">4</div>
                <div>Mod√®les IA Support√©s</div>
            </div>
            <div class="stat-card">
                <div class="stat-number">‚àû</div>
                <div>Possibilit√©s Cr√©atives</div>
            </div>
        </div>

        <div class="generator-section">
            <h2>üéØ G√©n√©rateur de Prompts Professionnel</h2>

            <div class="form-group">
                <label for="aiModel">ü§ñ Mod√®le IA pour G√©n√©ration :</label>
                <select id="aiModel" onchange="checkApiKey()">
                    <option value="openai">OpenAI GPT-4 (Recommand√©)</option>
                    <option value="openai-gpt35">OpenAI GPT-3.5 Turbo</option>
                    <option value="anthropic">Anthropic Claude 4 Sonnet</option>
                    <option value="google">Google Gemini</option>
                    <option value="ollama">Ollama (Local)</option>
                </select>
            </div>
            
            <div id="apiStatusSection" class="api-status-section">
                <div id="apiStatus" class="status-indicator status-success">
                    APIs configur√©es et pr√™tes √† utiliser
                </div>
                <button onclick="modifyApiConfig()" class="btn" style="margin-top: 10px;">
                    ‚úèÔ∏è Modifier la configuration
                </button>
            </div>

            <div id="apiConfigSection" class="api-config-section">
                <h3>üîë Configuration API Requise</h3>
                <p>Pour utiliser ce mod√®le IA, vous devez configurer votre cl√© API :</p>
                <div id="apiLinks"></div>
                <div id="apiKeyInput" class="api-key-input">
                    <label for="apiKeyField">Cl√© API :</label>
                    <input type="password" id="apiKeyField" placeholder="Collez votre cl√© API ici...">
                    <button onclick="saveApiKey()">Sauvegarder la Cl√©</button>
                    <button onclick="clearApiKeys()" class="clear-btn">Effacer toutes les cl√©s</button>
                </div>
                <div id="ollamaConfigButtons" style="display: none;">
                    <button onclick="saveOllamaConfig()" class="btn">Sauvegarder Configuration Ollama</button>
                </div>
            </div>

            <div class="tab-navigation">
                <button class="tab-btn active" onclick="switchTab('manual')">üé® Choix Manuel</button>
                <button class="tab-btn" onclick="switchTab('profession')">üëî Par M√©tier</button>
            </div>

            <div id="manualTab">
                <div class="form-group">
                    <label for="framework">üé® Choisissez votre Framework :</label>
                    <select id="framework" onchange="updateFrameworkPreview()">
                        <option value="">-- S√©lectionnez un framework --</option>
                        <optgroup label="üéØ Frameworks de Base">
                            <option value="rtf">R-T-F (R√¥le - T√¢che - Format)</option>
                            <option value="pao">P-A-O (Probl√®me - Action - Objectif)</option>
                            <option value="arp">A-R-P (Avant - R√©sultat - Point)</option>
                            <option value="care">C-A-R-E (Contexte - Action - R√©sultat - Exemple)</option>
                            <option value="riea">R-I-E-A (R√¥le - Info - √âtapes - Attente)</option>
                            <option value="aspecct">ASPECCT (Action - Sp√©cificit√© - Public - Exemples - Contraintes -
                                Clarifications - Ton)</option>
                        </optgroup>
                        <optgroup label="üß† Frameworks Avanc√©s">
                            <option value="tot">Tree-of-Thoughts</option>
                            <option value="cot">Chain-of-Thought</option>
                            <option value="star">S-T-A-R (Situation - Task - Action - Result)</option>
                            <option value="ideal">I-D-E-A-L (Identify - Define - Examine - Act - Look)</option>
                            <option value="stepback">Step-Back Prompting</option>
                            <option value="sharp">S-H-A-R-P (Situation - Hindrance - Action - Result - Perspective)
                            </option>
                            <option value="peel">P-E-E-L (Point - Evidence - Explanation - Link)</option>
                        </optgroup>
                        <optgroup label="üìä Frameworks M√©tier">
                            <option value="5w1h">5W1H (Who-What-When-Where-Why-How)</option>
                            <option value="scqa">S-C-Q-A (Situation - Complication - Question - Answer)</option>
                            <option value="latch">L-A-T-C-H (Location - Alphabet - Time - Category - Hierarchy)</option>
                        </optgroup>
                        <optgroup label="‚ö° Techniques Rapides">
                            <option value="expert">Expert Role Prompting</option>
                            <option value="stepbystep">Step-by-Step Reasoning</option>
                            <option value="eli5">Explain Like I'm 5</option>
                            <option value="multiple">Multiple Approaches</option>
                            <option value="socratic">Socratic Questioning</option>
                        </optgroup>
                    </select>
                </div>
            </div>

            <div id="professionTab" style="display: none;">
                <div class="profession-selection">
                    <h4>üëî S√©lectionnez votre M√©tier</h4>
                    <div class="form-group">
                        <select id="professionSelect" onchange="showRecommendedFrameworks()">
                            <option value="">-- Choisissez votre m√©tier --</option>
                            <option value="marketing">üìà Marketing & Communication</option>
                            <option value="development">üíª D√©veloppement & Tech</option>
                            <option value="management">üëî Management & Direction</option>
                            <option value="consulting">üéØ Conseil & Strat√©gie</option>
                            <option value="education">üìö √âducation & Formation</option>
                            <option value="sales">üíº Vente & Commercial</option>
                            <option value="hr">üë• Ressources Humaines</option>
                            <option value="finance">üí∞ Finance & Comptabilit√©</option>
                            <option value="creative">üé® Cr√©atif & Design</option>
                            <option value="operations">‚öôÔ∏è Op√©rations & Logistique</option>
                        </select>
                    </div>
                    <div id="recommendedFrameworks" class="recommended-frameworks" style="display: none;">
                        <h5>üéØ Frameworks Recommand√©s pour votre M√©tier</h5>
                        <div id="frameworkCards"></div>
                    </div>
                </div>
            </div>

            <div id="frameworkPreview" class="framework-preview">
                <!-- Aper√ßu du framework s√©lectionn√© -->
            </div>

            <div id="variableInputs" class="variable-inputs">
                <!-- Champs dynamiques selon le framework -->
            </div>

            <div id="standardFields">
                <div class="form-row">
                    <div class="form-group">
                        <label for="subject">üìù Sujet Principal :</label>
                        <textarea id="subject"
                            placeholder="D√©crivez votre demande, probl√®me ou objectif principal..."></textarea>
                    </div>
                    <div class="form-group">
                        <label for="context">üåç Contexte (optionnel) :</label>
                        <textarea id="context"
                            placeholder="Informations suppl√©mentaires, contraintes, contexte sp√©cifique..."></textarea>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="audience">üë• Audience Cible :</label>
                        <input type="text" id="audience"
                            placeholder="Ex: d√©veloppeurs seniors, dirigeants PME, √©tudiants...">
                    </div>
                    <div class="form-group">
                        <label for="tone">üé≠ Ton Souhait√© :</label>
                        <select id="tone">
                            <option value="professionnel">Professionnel</option>
                            <option value="amical">Amical</option>
                            <option value="technique">Technique</option>
                            <option value="cr√©atif">Cr√©atif</option>
                            <option value="analytique">Analytique</option>
                            <option value="persuasif">Persuasif</option>
                            <option value="√©ducatif">√âducatif</option>
                            <option value="conversationnel">Conversationnel</option>
                        </select>
                    </div>
                </div>

                <div class="form-group">
                    <label for="output">Format de Sortie Souhait√© :</label>
                    <select id="output">
                        <option value="structured">R√©ponse structur√©e avec titres</option>
                        <option value="bullets">Liste √† puces</option>
                        <option value="numbered">Liste num√©rot√©e</option>
                        <option value="paragraph">Paragraphes narratifs</option>
                        <option value="table">Format tableau</option>
                        <option value="json">Format JSON</option>
                        <option value="markdown">Format Markdown</option>
                        <option value="stepbystep">Guide √©tape par √©tape</option>
                    </select>
                </div>
            </div>

            <button class="generate-btn" onclick="generatePromptWithAI()" id="generateBtn">
                ü§ñ G√©n√©rer le Prompt avec IA
            </button>
        </div>

        <div id="resultSection" class="result-section">
            <h3>‚ú® Votre Prompt G√©n√©r√© par IA</h3>
            <div id="promptOutput" class="prompt-output"></div>
            <div class="action-buttons">
                <button class="btn" onclick="copyPrompt()">Copier</button>
                <button class="btn success" onclick="savePrompt()">Sauvegarder</button>
                <button class="btn warning" onclick="regenerateWithDifferentModel()">üîÑ R√©g√©n√©rer</button>
                <button class="btn primary" onclick="testPromptDirectly()" id="realTestBtn">Tester le prompt avec l'IA</button>
            </div>

            <div id="testResult" style="margin-top: 20px;"></div>
        </div>
    </div>


    <script>
        // Configuration √©tendue des frameworks
        const frameworks = {
            rtf: {
                name: "R-T-F (R√¥le - T√¢che - Format)",
                description: "Framework simple et efficace pour des prompts structur√©s",
                variables: ["role", "task", "format"],
                template: `R√îLE : {role}

T√ÇCHE : {task}

FORMAT : {format}`,
                professions: ["marketing", "development", "management", "consulting"]
            },
            pao: {
                name: "P-A-O (Probl√®me - Action - Objectif)",
                description: "Parfait pour la r√©solution de probl√®mes concrets",
                variables: ["problem", "action", "objective"],
                template: `PROBL√àME : {problem}

ACTION : {action}

OBJECTIF : {objective}`,
                professions: ["management", "consulting", "operations"]
            },
            arp: {
                name: "A-R-P (Avant - R√©sultat - Point)",
                description: "Id√©al pour les transformations et √©volutions strat√©giques",
                variables: ["before", "result", "point"],
                template: `AVANT : {before}

R√âSULTAT : {result}

POINT : {point}`,
                professions: ["management", "consulting", "sales"]
            },
            care: {
                name: "C-A-R-E (Contexte - Action - R√©sultat - Exemple)",
                description: "Framework complet avec exemples concrets",
                variables: ["context", "action", "result", "example"],
                template: `CONTEXTE : {context}

ACTION : {action}

R√âSULTAT : {result}

EXEMPLE : {example}`,
                professions: ["education", "consulting", "hr"]
            },
            riea: {
                name: "R-I-E-A (R√¥le - Info - √âtapes - Attente)",
                description: "Pour des syst√®mes d√©taill√©s et processus complexes",
                variables: ["role", "info", "steps", "expectation"],
                template: `R√îLE : {role}

INFO : {info}

√âTAPES : {steps}

ATTENTE : {expectation}`,
                professions: ["development", "operations", "hr"]
            },
            aspecct: {
                name: "ASPECCT (Action - Sp√©cificit√© - Public - Exemples - Contraintes - Clarifications - Ton)",
                description: "Framework ultra-complet pour demandes complexes",
                variables: ["action", "specificity", "public", "examples", "constraints", "clarifications", "tone"],
                template: `ACTION : {action}

SP√âCIFICIT√â : {specificity}

PUBLIC : {public}

EXEMPLES : {examples}

CONTRAINTES : {constraints}

CLARIFICATIONS : {clarifications}

TON : {tone}`,
                professions: ["marketing", "creative", "consulting"]
            },
            tot: {
                name: "Tree-of-Thoughts",
                description: "Exploration de multiples chemins de raisonnement",
                variables: ["problem", "approaches"],
                template: `Probl√®me √† r√©soudre : {problem}

G√©n√®re {approaches} approches diff√©rentes pour r√©soudre ce d√©fi.
Pour chaque approche :
1. D√©cris la m√©thode
2. √âvalue sur 10 : faisabilit√©, impact, co√ªt
3. Identifie les risques principaux

Ensuite, d√©veloppe en d√©tail les 2 meilleures approches.`,
                professions: ["consulting", "development", "management"]
            },
            cot: {
                name: "Chain-of-Thought",
                description: "Raisonnement √©tape par √©tape structur√©",
                variables: ["problem"],
                template: `R√©solvez ce probl√®me √©tape par √©tape :

{problem}

Analysons cela m√©thodiquement :
1. D'abord, identifions les √©l√©ments cl√©s
2. Ensuite, d√©composons le probl√®me
3. Puis, r√©solvons chaque partie
4. Finalement, synth√©tisons la r√©ponse

R√©flexion :`,
                professions: ["development", "education", "consulting"]
            },
            star: {
                name: "S-T-A-R (Situation - Task - Action - Result)",
                description: "Analyse de cas et retours d'exp√©rience",
                variables: ["situation", "task", "action", "result"],
                template: `Analysez selon la m√©thode STAR :

SITUATION : {situation}

TASK : {task}

ACTION : {action}

RESULT : {result}

Maintenant analysez : qu'est-ce qui a bien fonctionn√© et que feriez-vous diff√©remment ?`,
                professions: ["hr", "management", "consulting"]
            },
            ideal: {
                name: "I-D-E-A-L (Identify - Define - Examine - Act - Look)",
                description: "M√©thode consulting pour probl√®mes complexes",
                variables: ["identify", "define", "examine", "act", "look"],
                template: `R√©solvez ce probl√®me business avec I-D-E-A-L :

IDENTIFY : {identify}

DEFINE : {define}

EXAMINE : {examine}

ACT : {act}

LOOK : {look}`,
                professions: ["consulting", "management", "finance"]
            },
            stepback: {
                name: "Step-Back Prompting",
                description: "R√©solution par abstraction puis application",
                variables: ["general_question", "specific_question"],
                template: `D'abord, step-back : {general_question}

[Attendez la r√©ponse sur les principes g√©n√©raux]

Maintenant, en appliquant ces principes √† mon cas sp√©cifique : {specific_question}`,
                professions: ["education", "consulting", "development"]
            },
            sharp: {
                name: "S-H-A-R-P (Situation - Hindrance - Action - Result - Perspective)",
                description: "Analyse d'incident ou retour d'exp√©rience d√©taill√©",
                variables: ["situation", "hindrance", "action", "result", "perspective"],
                template: `SITUATION : {situation}

HINDRANCE : {hindrance}

ACTION : {action}

RESULT : {result}

PERSPECTIVE : {perspective}`,
                professions: ["operations", "management", "hr"]
            },
            peel: {
                name: "P-E-E-L (Point - Evidence - Explanation - Link)",
                description: "Framework argumentatif pour l'√©ducation et la persuasion",
                variables: ["point", "evidence", "explanation", "link"],
                template: `POINT : {point}

EVIDENCE : {evidence}

EXPLANATION : {explanation}

LINK : {link}`,
                professions: ["education", "sales", "marketing"]
            },
            "5w1h": {
                name: "5W1H (Who-What-When-Where-Why-How)",
                description: "Analyse journalistique compl√®te pour brainstorming et investigation",
                variables: ["who", "what", "when", "where", "why", "how"],
                template: `WHO : {who}

WHAT : {what}

WHEN : {when}

WHERE : {where}

WHY : {why}

HOW : {how}`,
                professions: ["marketing", "consulting", "operations"]
            },
            scqa: {
                name: "S-C-Q-A (Situation - Complication - Question - Answer)",
                description: "Framework consulting McKinsey pour structurer une pr√©sentation",
                variables: ["situation", "complication", "question", "answer"],
                template: `SITUATION : {situation}

COMPLICATION : {complication}

QUESTION : {question}

ANSWER : {answer}`,
                professions: ["consulting", "management", "finance"]
            },
            latch: {
                name: "L-A-T-C-H (Location - Alphabet - Time - Category - Hierarchy)",
                description: "Organisation et pr√©sentation d'information complexe",
                variables: ["location", "alphabet", "time", "category", "hierarchy"],
                template: `LOCATION : {location}

ALPHABET : {alphabet}

TIME : {time}

CATEGORY : {category}

HIERARCHY : {hierarchy}`,
                professions: ["creative", "education", "operations"]
            },
            expert: {
                name: "Expert Role Prompting",
                description: "Perspective d'expert sp√©cialis√©",
                variables: ["expertise", "experience"],
                template: `Tu es un expert en {expertise} avec {experience} ann√©es d'exp√©rience.

En tant que sp√©cialiste reconnu dans ce domaine, r√©ponds √† cette question avec ton expertise approfondie :`,
                professions: ["consulting", "development", "finance"]
            },
            stepbystep: {
                name: "Step-by-Step Reasoning",
                description: "Raisonnement simple et m√©thodique",
                variables: [],
                template: `Analysons cela √©tape par √©tape.

Prenons une approche m√©thodique pour r√©soudre ce probl√®me :`,
                professions: ["education", "development", "operations"]
            },
            eli5: {
                name: "Explain Like I'm 5",
                description: "Simplification maximale et vulgarisation",
                variables: [],
                template: `Explique-moi cela comme si j'avais 5 ans.

Utilise des mots simples, des analogies et des exemples concrets que m√™me un enfant pourrait comprendre :`,
                professions: ["education", "marketing", "hr"]
            },
            multiple: {
                name: "Multiple Approaches",
                description: "G√©n√©ration de solutions diversifi√©es",
                variables: ["number"],
                template: `Donne-moi {number} approches diff√©rentes pour r√©soudre ce d√©fi.

Pour chaque approche, explique :
- La m√©thode principale
- Les avantages
- Les inconv√©nients
- Un exemple concret d'application`,
                professions: ["consulting", "creative", "management"]
            },
            socratic: {
                name: "Socratic Questioning",
                description: "M√©thode socratique pour l'apprentissage par questionnement",
                variables: ["topic"],
                template: `Utilise la m√©thode socratique pour m'enseigner : {topic}

Au lieu de donner des r√©ponses directes, guide-moi avec des questions qui m'am√®neront √† d√©couvrir les concepts par moi-m√™me.

Commence par une question fondamentale :`,
                professions: ["education", "consulting", "hr"]
            }
        };

        // Configuration des APIs
        const apiConfig = {
            openai: {
                name: "OpenAI",
                url: "https://platform.openai.com/api-keys",
                models: ["GPT-4", "GPT-3.5 Turbo"]
            },
            anthropic: {
                name: "Anthropic",
                url: "https://console.anthropic.com/account/keys",
                models: ["Claude 4 Sonnet"]
            },
            google: {
                name: "Google",
                url: "https://makersuite.google.com/app/apikey",
                models: ["Gemini"]
            },
            ollama: {
                name: "Ollama",
                url: "http://localhost:11434",
                models: [],
                requiresUrl: true
            }
        };

        // Frameworks recommand√©s par m√©tier
        const professionFrameworks = {
            marketing: ["rtf", "aspecct", "peel", "5w1h", "eli5"],
            development: ["riea", "tot", "cot", "stepbystep", "expert"],
            management: ["pao", "arp", "star", "ideal", "multiple"],
            consulting: ["scqa", "ideal", "tot", "expert", "stepback"],
            education: ["care", "eli5", "stepbystep", "socratic", "peel"],
            sales: ["arp", "peel", "star", "rtf", "eli5"],
            hr: ["star", "care", "sharp", "socratic", "riea"],
            finance: ["ideal", "scqa", "expert", "stepbystep", "5w1h"],
            creative: ["aspecct", "multiple", "latch", "eli5", "rtf"],
            operations: ["sharp", "riea", "stepbystep", "5w1h", "latch"]
        };

        // Variables globales
        let currentFramework = null;
        let apiKeys = {};
        let currentTab = 'manual';

        // Initialisation
        document.addEventListener('DOMContentLoaded', function () {
            loadApiKeys();
            
            // Restaurer le dernier mod√®le s√©lectionn√©
            const lastModel = localStorage.getItem('promptgen_last_model');
            if (lastModel) {
                const modelSelect = document.getElementById('aiModel');
                if (modelSelect) {
                    // V√©rifier si l'option existe
                    const options = Array.from(modelSelect.options);
                    if (options.some(opt => opt.value === lastModel)) {
                        modelSelect.value = lastModel;
                    }
                }
            }
            
            checkApiKey();
        });

        // Chargement des cl√©s API depuis le localStorage (simulation .env)
        function loadApiKeys() {
            try {
                const saved = localStorage.getItem('promptgen_api_keys');
                if (saved) {
                    apiKeys = JSON.parse(saved);
                }
            } catch (error) {
                console.error('Erreur lors du chargement des cl√©s API:', error);
            }
        }

        // Sauvegarde des cl√©s API
        function saveApiKeys() {
            try {
                localStorage.setItem('promptgen_api_keys', JSON.stringify(apiKeys));
            } catch (error) {
                console.error('Erreur lors de la sauvegarde des cl√©s API:', error);
            }
        }

        // V√©rification de la cl√© API pour le mod√®le s√©lectionn√©
        function checkApiKey() {
            const aiModel = document.getElementById('aiModel').value;
            const modelProvider = aiModel.split('-')[0]; // openai, anthropic, google, ollama

            // Sauvegarder le mod√®le s√©lectionn√©
            localStorage.setItem('promptgen_last_model', aiModel);

            const apiStatusSection = document.getElementById('apiStatusSection');
            const apiConfigSection = document.getElementById('apiConfigSection');

            if (modelProvider === 'ollama') {
                // Configuration sp√©ciale pour Ollama
                const ollamaConfig = apiKeys[modelProvider];
                if (ollamaConfig && ollamaConfig.url && ollamaConfig.selectedModel) {
                    apiStatusSection.style.display = 'block';
                    apiConfigSection.style.display = 'none';
                    document.getElementById('generateBtn').disabled = false;
                    document.getElementById('apiStatus').innerHTML = `Ollama configur√© : ${ollamaConfig.selectedModel} sur ${ollamaConfig.url}`;
                } else {
                    apiStatusSection.style.display = 'none';
                    apiConfigSection.style.display = 'block';
                    
                    document.getElementById('apiLinks').innerHTML = `
                        <div class="ollama-config">
                            <p>Configurez votre instance Ollama locale :</p>
                            <div class="form-group">
                                <label for="ollamaUrl">URL Ollama :</label>
                                <input type="text" id="ollamaUrl" placeholder="http://localhost:11434" value="${ollamaConfig?.url || 'http://localhost:11434'}">
                            </div>
                            <div class="form-group">
                                <label for="ollamaModel">Mod√®le Ollama :</label>
                                <select id="ollamaModel">
                                    <option value="">-- Choisir un mod√®le --</option>
                                </select>
                                <button onclick="loadOllamaModels()" class="btn">üîÑ Charger les mod√®les</button>
                            </div>
                        </div>
                    `;
                    
                    // Cacher les champs de cl√© API standard pour Ollama
                    document.getElementById('apiKeyInput').style.display = 'none';
                    document.getElementById('ollamaConfigButtons').style.display = 'block';
                    
                    document.getElementById('generateBtn').disabled = true;
                    
                    // Charger automatiquement les mod√®les si une URL est d√©finie
                    if (ollamaConfig?.url || !ollamaConfig) {
                        // Utiliser setTimeout pour s'assurer que le DOM est pr√™t
                        setTimeout(() => {
                            loadOllamaModels(ollamaConfig?.selectedModel);
                        }, 100);
                    }
                }
            } else if (apiKeys[modelProvider]) {
                // Cl√© API disponible
                apiStatusSection.style.display = 'block';
                apiConfigSection.style.display = 'none';
                document.getElementById('generateBtn').disabled = false;
                document.getElementById('apiStatus').innerHTML = 'APIs configur√©es et pr√™tes √† utiliser';
            } else {
                // Cl√© API manquante
                apiStatusSection.style.display = 'none';
                apiConfigSection.style.display = 'block';

                const config = apiConfig[modelProvider];
                document.getElementById('apiLinks').innerHTML = `
                    <p>Obtenez votre cl√© API ${config.name} :</p>
                    <a href="${config.url}" target="_blank" class="api-link">
                        üîó Cr√©er une cl√© API ${config.name}
                    </a>
                `;

                // R√©afficher les champs de cl√© API standard
                document.getElementById('apiKeyInput').style.display = 'block';
                document.getElementById('ollamaConfigButtons').style.display = 'none';

                document.getElementById('generateBtn').disabled = true;
            }
        }

        // Sauvegarde d'une nouvelle cl√© API
        function saveApiKey() {
            const aiModel = document.getElementById('aiModel').value;
            const modelProvider = aiModel.split('-')[0];
            
            // Si c'est Ollama, utiliser saveOllamaConfig √† la place
            if (modelProvider === 'ollama') {
                saveOllamaConfig();
                return;
            }
            
            const apiKey = document.getElementById('apiKeyField').value.trim();

            if (!apiKey) {
                alert('Veuillez saisir une cl√© API valide');
                return;
            }

            // Validation basique de la cl√©
            const validations = {
                openai: key => key.startsWith('sk-'),
                anthropic: key => key.startsWith('sk-ant-'),
                google: key => key.startsWith('AIza'),
                ollama: key => true // Ollama n'a pas besoin de cl√© API
            };

            if (validations[modelProvider] && !validations[modelProvider](apiKey)) {
                alert('Format de cl√© API invalide pour ' + apiConfig[modelProvider].name);
                return;
            }

            // Sauvegarde
            apiKeys[modelProvider] = apiKey;
            saveApiKeys();

            // Interface
            document.getElementById('apiKeyField').value = '';
            checkApiKey();

            alert('Cl√© API sauvegard√©e avec succ√®s !');
        }

        // Effacement de toutes les cl√©s API
        function clearApiKeys() {
            if (confirm('‚ö†Ô∏è √ätes-vous s√ªr de vouloir effacer toutes les cl√©s API sauvegard√©es ? Cette action est irr√©versible.')) {
                try {
                    // Vider l'objet apiKeys
                    apiKeys = {};
                    
                    // Supprimer du localStorage
                    localStorage.removeItem('promptgen_api_keys');
                    
                    // Vider le champ de saisie
                    document.getElementById('apiKeyField').value = '';
                    
                    // Mettre √† jour l'interface
                    checkApiKey();
                    
                    alert('Toutes les cl√©s API ont √©t√© effac√©es avec succ√®s !');
                } catch (error) {
                    console.error('Erreur lors de l\'effacement des cl√©s API:', error);
                    alert('Erreur lors de l\'effacement des cl√©s API');
                }
            }
        }

        // Charger les mod√®les disponibles depuis Ollama
        async function loadOllamaModels(selectedModel = null) {
            const ollamaUrlElement = document.getElementById('ollamaUrl');
            if (!ollamaUrlElement) {
                // Si l'√©l√©ment n'existe pas encore, attendre un peu et r√©essayer
                setTimeout(() => loadOllamaModels(selectedModel), 100);
                return;
            }
            
            const ollamaUrl = ollamaUrlElement.value.trim();
            if (!ollamaUrl) {
                console.log('URL Ollama non d√©finie');
                return;
            }

            try {
                const response = await fetch(`${ollamaUrl}/api/tags`);
                if (!response.ok) {
                    throw new Error('Impossible de se connecter √† Ollama');
                }

                const data = await response.json();
                const models = data.models || [];
                
                const modelSelect = document.getElementById('ollamaModel');
                if (!modelSelect) {
                    console.error('Element ollamaModel non trouv√©');
                    return;
                }
                
                modelSelect.innerHTML = '<option value="">-- Choisir un mod√®le --</option>';
                
                models.forEach(model => {
                    const option = document.createElement('option');
                    option.value = model.name;
                    option.textContent = `${model.name} (${formatSize(model.size)})`;
                    if (selectedModel && model.name === selectedModel) {
                        option.selected = true;
                    }
                    modelSelect.appendChild(option);
                });

                if (models.length === 0) {
                    // Ne pas afficher d'alerte au chargement automatique
                    console.log('Aucun mod√®le Ollama trouv√©');
                } else {
                    // Afficher le bouton de sauvegarde
                    document.getElementById('ollamaConfigButtons').style.display = 'block';
                    
                    // Si un mod√®le √©tait pr√©s√©lectionn√© et existe toujours, activer le bouton de g√©n√©ration
                    if (selectedModel && models.some(m => m.name === selectedModel)) {
                        // Sauvegarder automatiquement si tout est configur√©
                        const ollamaConfig = apiKeys['ollama'];
                        if (ollamaConfig && ollamaConfig.url === ollamaUrl && ollamaConfig.selectedModel === selectedModel) {
                            checkApiKey();
                        }
                    }
                }
            } catch (error) {
                console.error(`Erreur lors du chargement des mod√®les : ${error.message}`);
                // Ne pas afficher d'alerte au chargement automatique
            }
        }

        // Sauvegarder la configuration Ollama
        function saveOllamaConfig() {
            const ollamaUrl = document.getElementById('ollamaUrl').value.trim();
            const selectedModel = document.getElementById('ollamaModel').value;

            if (!ollamaUrl || !selectedModel) {
                alert('Veuillez s√©lectionner une URL et un mod√®le');
                return;
            }

            apiKeys['ollama'] = {
                url: ollamaUrl,
                selectedModel: selectedModel
            };

            saveApiKeys();
            checkApiKey();
        }

        // Formater la taille des mod√®les
        function formatSize(bytes) {
            if (bytes < 1024 * 1024 * 1024) {
                return (bytes / (1024 * 1024)).toFixed(0) + ' MB';
            }
            return (bytes / (1024 * 1024 * 1024)).toFixed(1) + ' GB';
        }

        // Modifier la configuration API
        function modifyApiConfig() {
            const aiModel = document.getElementById('aiModel').value;
            const modelProvider = aiModel.split('-')[0];
            
            // Supprimer temporairement la configuration pour forcer l'affichage du formulaire
            if (modelProvider === 'ollama') {
                // Pour Ollama, on garde l'URL mais on supprime le mod√®le s√©lectionn√©
                if (apiKeys['ollama']) {
                    const ollamaUrl = apiKeys['ollama'].url;
                    apiKeys['ollama'] = { url: ollamaUrl };
                    saveApiKeys();
                }
            } else {
                // Pour les autres APIs, supprimer compl√®tement la cl√©
                delete apiKeys[modelProvider];
                saveApiKeys();
            }
            
            // R√©afficher le formulaire de configuration
            checkApiKey();
        }

        // Gestion des onglets
        function switchTab(tab) {
            currentTab = tab;

            // Mise √† jour des boutons
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');

            // Affichage des sections
            if (tab === 'manual') {
                document.getElementById('manualTab').style.display = 'block';
                document.getElementById('professionTab').style.display = 'none';
            } else {
                document.getElementById('manualTab').style.display = 'none';
                document.getElementById('professionTab').style.display = 'block';
            }

            // Reset des s√©lections
            resetFrameworkSelection();
        }

        // Affichage des frameworks recommand√©s par m√©tier
        function showRecommendedFrameworks() {
            const profession = document.getElementById('professionSelect').value;
            const container = document.getElementById('recommendedFrameworks');
            const cardsContainer = document.getElementById('frameworkCards');

            if (!profession) {
                container.style.display = 'none';
                return;
            }

            container.style.display = 'block';

            const recommended = professionFrameworks[profession] || [];
            let cardsHtml = '';

            recommended.forEach(frameworkId => {
                const framework = frameworks[frameworkId];
                if (framework) {
                    cardsHtml += `
                        <div class="framework-card" onclick="selectFrameworkCard('${frameworkId}', this)">
                            <h6>${framework.name}</h6>
                            <p>${framework.description}</p>
                        </div>
                    `;
                }
            });

            cardsContainer.innerHTML = cardsHtml;
        }

        // S√©lection d'un framework via carte
        function selectFrameworkCard(frameworkId, cardElement) {
            // D√©s√©lection des autres cartes
            document.querySelectorAll('.framework-card').forEach(card => {
                card.classList.remove('selected');
            });

            // S√©lection de la carte actuelle
            cardElement.classList.add('selected');

            // Mise √† jour du framework actuel
            currentFramework = frameworks[frameworkId];
            updateFrameworkPreview(frameworkId);
        }

        // Reset de la s√©lection des frameworks
        function resetFrameworkSelection() {
            document.getElementById('framework').value = '';
            document.getElementById('professionSelect').value = '';
            document.getElementById('recommendedFrameworks').style.display = 'none';
            document.querySelectorAll('.framework-card').forEach(card => {
                card.classList.remove('selected');
            });

            // Reset de l'aper√ßu
            document.getElementById('frameworkPreview').style.display = 'none';
            document.getElementById('variableInputs').style.display = 'none';
            document.getElementById('standardFields').style.display = 'block';

            currentFramework = null;
        }

        // Mise √† jour de l'aper√ßu du framework
        function updateFrameworkPreview(frameworkId = null) {
            const selectedFramework = frameworkId || document.getElementById('framework').value;
            const previewDiv = document.getElementById('frameworkPreview');
            const variableInputsDiv = document.getElementById('variableInputs');
            const standardFieldsDiv = document.getElementById('standardFields');

            if (selectedFramework && frameworks[selectedFramework]) {
                currentFramework = frameworks[selectedFramework];

                // Affichage de l'aper√ßu
                previewDiv.style.display = 'block';
                previewDiv.classList.add('show');
                previewDiv.innerHTML = `
                    <h4>${currentFramework.name}</h4>
                    <p><em>${currentFramework.description}</em></p>
                    <pre style="background: white; padding: 20px; border-radius: 10px; border-left: 4px solid #28a745; margin-top: 15px; font-family: 'Monaco', monospace;">${currentFramework.template}</pre>
                `;

                // Frameworks avec variables sp√©cifiques qui remplacent les champs standards
                const frameworksWithSpecialFields = ['rtf', 'pao', 'arp', 'care', 'riea', 'aspecct', 'star', 'ideal', 'sharp', 'peel', '5w1h', 'scqa', 'latch'];
                const hasSpecialFields = frameworksWithSpecialFields.includes(selectedFramework);

                // G√©n√©ration des champs de variables
                if (currentFramework.variables && currentFramework.variables.length > 0) {
                    variableInputsDiv.style.display = 'block';
                    variableInputsDiv.classList.add('show');

                    let variableHTML = '<h4>üéØ Variables Sp√©cifiques du Framework :</h4>';

                    if (hasSpecialFields) {
                        variableHTML += '<div class="warning-message">‚ö†Ô∏è <strong>Important :</strong> Pour ce framework, utilisez les champs ci-dessous au lieu des champs standards</div>';
                        standardFieldsDiv.style.display = 'none';
                    } else {
                        standardFieldsDiv.style.display = 'block';
                    }

                    currentFramework.variables.forEach(variable => {
                        const label = getVariableLabel(variable);
                        const placeholder = getVariablePlaceholder(variable);
                        variableHTML += `
                            <div class="variable-input">
                                <label for="var_${variable}">${label} :</label>
                                <input type="text" id="var_${variable}" placeholder="${placeholder}">
                            </div>
                        `;
                    });

                    variableInputsDiv.innerHTML = variableHTML;
                } else {
                    variableInputsDiv.style.display = 'none';
                    variableInputsDiv.classList.remove('show');
                    standardFieldsDiv.style.display = 'block';
                }

            } else {
                // Aucun framework s√©lectionn√©
                previewDiv.style.display = 'none';
                previewDiv.classList.remove('show');
                variableInputsDiv.style.display = 'none';
                variableInputsDiv.classList.remove('show');
                standardFieldsDiv.style.display = 'block';
                currentFramework = null;
            }
        }

        // Labels pour les variables (fonction existante - inchang√©e)
        function getVariableLabel(variable) {
            const labels = {
                role: 'üë§ R√¥le/Expertise',
                task: 'üéØ T√¢che √† accomplir',
                format: 'Format de sortie',
                problem: '‚ùó Probl√®me √† r√©soudre',
                action: '‚ö° Action demand√©e',
                objective: 'üéØ Objectif final',
                before: 'üìç Situation actuelle',
                result: 'üèÜ R√©sultat souhait√©',
                point: 'üîë Point cl√© demand√©',
                context: 'üåç Contexte',
                example: 'üí° Exemple souhait√©',
                info: '‚ÑπÔ∏è Informations',
                steps: '√âtapes demand√©es',
                expectation: 'üéØ Attente',
                specificity: 'üîç Sp√©cificit√©',
                public: 'üë• Public cible',
                examples: 'üí° Exemples',
                constraints: '‚ö†Ô∏è Contraintes',
                clarifications: 'üí¨ Clarifications',
                tone: 'üé≠ Ton',
                approaches: 'üî¢ Nombre d\'approches',
                situation: 'üìç Situation',
                identify: 'üîç Probl√®me identifi√©',
                define: 'Objectifs d√©finis',
                examine: 'üßê Alternatives examin√©es',
                act: '‚ö° Plan d\'action',
                look: 'üëÄ Suivi et √©valuation',
                general_question: '‚ùì Question g√©n√©rale',
                specific_question: 'üéØ Question sp√©cifique',
                expertise: 'üéì Domaine d\'expertise',
                experience: '‚è±Ô∏è Ann√©es d\'exp√©rience',
                number: 'üî¢ Nombre de solutions',
                hindrance: 'üöß Obstacle/Difficult√©',
                perspective: 'üëÅÔ∏è Perspective/Apprentissage',
                evidence: 'üìä Preuves/Donn√©es',
                explanation: 'üí≠ Explication',
                link: 'üîó Lien/Transition',
                who: 'üë§ Qui',
                what: '‚ùì Quoi',
                when: '‚è∞ Quand',
                where: 'üìç O√π',
                why: 'ü§î Pourquoi',
                how: 'üîß Comment',
                complication: '‚ö†Ô∏è Complication',
                question: '‚ùì Question cl√©',
                answer: 'R√©ponse',
                location: 'üó∫Ô∏è Localisation',
                alphabet: 'üî§ Ordre alphab√©tique',
                time: '‚è∞ Chronologie',
                category: 'üìÇ Cat√©gorie',
                hierarchy: 'üìä Hi√©rarchie',
                topic: 'üìö Sujet d\'apprentissage',
                character: 'üé≠ Personnage/R√¥le',
                request: 'Demande',
                adjustments: '‚öôÔ∏è Ajustements',
                extras: '‚ú® Extras',
                retrieve: 'üîç R√©cup√©rer',
                augment: 'üìà Augmenter',
                generate: 'üéØ G√©n√©rer',
                observation: 'üëÅÔ∏è Observation',
                thought: 'üí≠ R√©flexion',
                initial_context: 'üå± Contexte initial',
                progression_steps: 'üìà √âtapes de progression',
                background: 'üìñ Contexte',
                reach: 'üìä Port√©e',
                confidence: 'üí™ Confiance',
                effort: '‚ö° Effort',
                strengths: 'üí™ Forces',
                weaknesses: '‚ö†Ô∏è Faiblesses',
                opportunities: 'üåü Opportunit√©s',
                threats: 'üö® Menaces',
                remember: 'üß† Se souvenir',
                understand: 'üí° Comprendre',
                apply: '‚öôÔ∏è Appliquer',
                analyze: 'üî¨ Analyser',
                evaluate: '‚öñÔ∏è √âvaluer',
                create: 'üé® Cr√©er',
                reaction: 'üòä R√©action',
                learning: 'üìö Apprentissage',
                behavior: 'üîÑ Comportement',
                results: 'üéØ R√©sultats',
                design: 'üé® Conception',
                develop: 'üõ†Ô∏è D√©veloppement',
                implement: 'Impl√©mentation',
                substitution: 'üîÑ Substitution',
                augmentation: 'üìà Augmentation',
                modification: '‚öôÔ∏è Modification',
                redefinition: 'üéØ Red√©finition',
                solution: 'üí° Solution',
                key_metrics: 'üìä M√©triques cl√©s',
                value_proposition: 'üíé Proposition de valeur',
                unfair_advantage: 'Avantage concurrentiel',
                objective: 'üéØ Objectif',
                key_result_1: 'üîë R√©sultat cl√© 1',
                key_result_2: 'üîë R√©sultat cl√© 2',
                key_result_3: 'üîë R√©sultat cl√© 3',
                specific: 'üéØ Sp√©cifique',
                measurable: 'üìè Mesurable',
                achievable: 'Atteignable',
                relevant: 'üéØ Pertinent',
                time_bound: '‚è∞ Temporel',
                political: 'üèõÔ∏è Politique',
                economic: 'üí∞ √âconomique',
                social: 'üë• Social',
                technological: 'üíª Technologique',
                environmental: 'üåç Environnemental',
                legal: '‚öñÔ∏è L√©gal',
                competitive_rivalry: '‚öîÔ∏è Rivalit√© concurrentielle',
                supplier_power: 'üè≠ Pouvoir fournisseurs',
                buyer_power: 'üí∞ Pouvoir acheteurs',
                threat_of_substitution: 'üîÑ Menace substituts',
                threat_of_new_entry: 'üö™ Menace nouveaux entrants',
                key_partners: 'ü§ù Partenaires cl√©s',
                key_activities: '‚öôÔ∏è Activit√©s cl√©s',
                value_propositions: 'üíé Propositions de valeur',
                customer_relationships: '‚ù§Ô∏è Relations clients',
                customer_segments: 'üë• Segments clients',
                population: 'üë• Population',
                intervention: 'üíä Intervention',
                comparison: '‚öñÔ∏è Comparaison',
                outcome: 'üéØ R√©sultat',
                identification: 'üîç Identification',
                screening: 'üîé Criblage',
                eligibility: '√âligibilit√©',
                included: 'Inclus',
                introduction: 'üìñ Introduction',
                methods: 'üî¨ M√©thodes',
                analysis: 'üìä Analyse',
                discussion: 'üí¨ Discussion',
                hypothesis: 'üß™ Hypoth√®se',
                test_method: 'üî¨ M√©thode de test',
                expected_result: 'üéØ R√©sultat attendu',
                validation_criteria: 'Crit√®res validation',
                source_domain: 'üè† Domaine source',
                target_domain: 'üéØ Domaine cible',
                mapping: 'üîó Correspondance',
                position: 'üìç Position',
                counterarguments: '‚öîÔ∏è Contre-arguments',
                white_facts: '‚ö™ Faits',
                red_emotions: 'üî¥ √âmotions',
                black_caution: '‚ö´ Prudence',
                yellow_optimism: 'üü° Optimisme',
                green_creativity: 'üü¢ Cr√©ativit√©',
                blue_process: 'üîµ Processus',
                substitute: 'üîÑ Substituer',
                combine: 'ü§ù Combiner',
                adapt: 'üîß Adapter',
                modify: '‚öôÔ∏è Modifier',
                put_to_other_uses: '‚ôªÔ∏è Autres usages',
                eliminate: '√âliminer',
                reverse: 'üîÑ Inverser',
                challenge: 'üéØ D√©fi',
                criteria: 'üìè Crit√®res',
                time_limit: '‚è∞ Limite temps',
                empathize: '‚ù§Ô∏è Empathie',
                ideate: 'üí° Id√©ation',
                prototype: 'üõ†Ô∏è Prototype',
                test: 'üß™ Test',
                discover: 'üîç D√©couvrir',
                deliver: 'Livrer'
            };
            return labels[variable] || variable.charAt(0).toUpperCase() + variable.slice(1);
        }

        // Placeholders pour les variables (fonction existante - inchang√©e mais √©tendue)
        function getVariablePlaceholder(variable) {
            const placeholders = {
                role: 'Ex: Expert en marketing digital, Consultant senior...',
                task: 'Ex: Cr√©er une strat√©gie, Analyser les donn√©es...',
                format: 'Ex: Liste √† puces, Rapport structur√©, Tableau...',
                problem: 'Ex: Baisse des ventes, √âquipe d√©motiv√©e...',
                action: 'Ex: Proposer des solutions, Cr√©er un plan...',
                objective: 'Ex: Augmenter les revenus de 30%, Am√©liorer la satisfaction...',
                before: 'Ex: Startup 5 personnes, CA 100K‚Ç¨...',
                result: 'Ex: Entreprise structur√©e, CA 1M‚Ç¨...',
                point: 'Ex: Plan de croissance, Strat√©gie de recrutement...',
                context: 'Ex: Secteur tech, Budget limit√©, √âquipe junior...',
                example: 'Ex: Cas d\'entreprises similaires, Benchmarks...',
                info: 'Ex: Budget 50K‚Ç¨, √âquipe de 3 personnes...',
                steps: 'Ex: √âtapes d√©taill√©es, Process complet...',
                expectation: 'Ex: Plan actionnable, ROI calcul√©...',
                specificity: 'Ex: Focus B2B, March√© fran√ßais...',
                public: 'Ex: Dirigeants PME, D√©veloppeurs seniors...',
                examples: 'Ex: Airbnb, Uber, Tesla...',
                constraints: 'Ex: Budget 100K‚Ç¨, D√©lai 6 mois...',
                clarifications: 'Ex: Priorit√© innovation, √âviter le risque...',
                tone: 'Ex: Professionnel, Cr√©atif, Technique...',
                approaches: 'Ex: 3, 5, 7...',
                situation: 'Ex: Projet en retard, Budget d√©pass√©...',
                identify: 'Ex: Churn rate √©lev√©, Co√ªts excessifs...',
                define: 'Ex: R√©duire le churn de 50%, ROI positif...',
                examine: 'Ex: 5 solutions possibles...',
                act: 'Ex: Plan en 3 phases...',
                look: 'Ex: KPIs mensuels, reporting...',
                general_question: 'Ex: Quels sont les principes de...',
                specific_question: 'Ex: Comment appliquer √† mon cas...',
                expertise: 'Ex: marketing digital, d√©veloppement web...',
                experience: 'Ex: 10, 15, 20...',
                number: 'Ex: 3, 5, 7...',
                hindrance: 'Ex: Manque de budget, R√©sistance au changement...',
                perspective: 'Ex: Le√ßons apprises, Am√©liorations futures...',
                evidence: 'Ex: Statistiques, √âtudes de cas...',
                explanation: 'Ex: Analyse des causes, M√©canismes...',
                link: 'Ex: Donc, Par cons√©quent, En conclusion...',
                who: 'Ex: L\'√©quipe marketing, Les clients...',
                what: 'Ex: Nouvelle strat√©gie, Produit innovant...',
                when: 'Ex: Q1 2024, D\'ici 6 mois...',
                where: 'Ex: March√© fran√ßais, En ligne...',
                why: 'Ex: Besoin urgent, Opportunit√© march√©...',
                how: 'Ex: M√©thodologie agile, Partenariats...',
                complication: 'Ex: Budget r√©duit, Concurrence forte...',
                question: 'Ex: Comment augmenter les ventes ?...',
                answer: 'Ex: Strat√©gie omnicanale...',
                location: 'Ex: Par r√©gion, Par bureau...',
                alphabet: 'Ex: De A √† Z, Par ordre alphab√©tique...',
                time: 'Ex: Chronologique, Historique...',
                category: 'Ex: Par type, Par th√®me...',
                hierarchy: 'Ex: Du plus important au moins...',
                topic: 'Ex: Machine Learning, Marketing Digital...',
                character: 'Ex: Expert consultant, Mentor bienveillant...',
                request: 'Ex: Analyse d√©taill√©e, Plan strat√©gique...',
                adjustments: 'Ex: Ton moins formel, Plus d\'exemples...',
                extras: 'Ex: Sources, Templates, Checklist...',
                retrieve: 'Ex: Informations pertinentes, Documents...',
                augment: 'Ex: Contexte enrichi, Donn√©es suppl√©mentaires...',
                generate: 'Ex: R√©ponse compl√®te, Solution d√©taill√©e...',
                observation: 'Ex: Situation actuelle, Donn√©es observ√©es...',
                thought: 'Ex: Analyse, R√©flexion strat√©gique...',
                initial_context: 'Ex: Probl√®me de d√©part, Situation initiale...',
                progression_steps: 'Ex: 3 √©tapes, 5 phases...',
                background: 'Ex: Contexte historique, Situation actuelle...',
                reach: 'Ex: 1000 utilisateurs, March√© national...',
                confidence: 'Ex: 80%, √âlev√©e, Moyenne...',
                effort: 'Ex: 2 semaines, 5 d√©veloppeurs...',
                strengths: 'Ex: Expertise technique, √âquipe solide...',
                weaknesses: 'Ex: Budget limit√©, Manque exp√©rience...',
                opportunities: 'Ex: March√© croissant, Nouvelle technologie...',
                threats: 'Ex: Concurrence forte, R√©glementation...',
                remember: 'Ex: D√©finitions, Concepts de base...',
                understand: 'Ex: Principes, Relations causales...',
                apply: 'Ex: Exercices pratiques, Cas d\'usage...',
                analyze: 'Ex: Comparaisons, D√©composition...',
                evaluate: 'Ex: Critique, Jugement qualit√©...',
                create: 'Ex: Nouveau mod√®le, Solution originale...',
                reaction: 'Ex: Satisfaction participants, Feedback...',
                learning: 'Ex: Connaissances acquises, Comp√©tences...',
                behavior: 'Ex: Application pratique, Changements...',
                results: 'Ex: ROI, Impact business...',
                design: 'Ex: Architecture, Maquettes...',
                develop: 'Ex: Prototypes, Contenu...',
                implement: 'Ex: D√©ploiement, Formation...',
                substitution: 'Ex: Remplacer papier par num√©rique...',
                augmentation: 'Ex: Ajouter fonctionnalit√©s...',
                modification: 'Ex: Changer m√©thode p√©dagogique...',
                redefinition: 'Ex: Transformer compl√®tement...',
                solution: 'Ex: App mobile, Service automatis√©...',
                key_metrics: 'Ex: CAC, LTV, Churn rate...',
                value_proposition: 'Ex: Gain de temps 50%, Co√ªt r√©duit...',
                unfair_advantage: 'Ex: Brevet, R√©seau exclusif...',
                objective: 'Ex: Am√©liorer satisfaction client...',
                key_result_1: 'Ex: NPS > 70...',
                key_result_2: 'Ex: Temps r√©ponse < 2h...',
                key_result_3: 'Ex: R√©duction plaintes 30%...',
                specific: 'Ex: Augmenter ventes produit X...',
                measurable: 'Ex: +25% de revenus...',
                achievable: 'Ex: Avec ressources actuelles...',
                relevant: 'Ex: Align√© strat√©gie entreprise...',
                time_bound: 'Ex: D\'ici 6 mois...',
                political: 'Ex: Stabilit√© gouvernement, R√©glementation...',
                economic: 'Ex: Inflation, Taux de change...',
                social: 'Ex: Tendances d√©mographiques...',
                technological: 'Ex: IA, Blockchain, IoT...',
                environmental: 'Ex: Climat, D√©veloppement durable...',
                legal: 'Ex: RGPD, Droit du travail...',
                competitive_rivalry: 'Ex: Concurrence intense, Prix...',
                supplier_power: 'Ex: Monopole fournisseur...',
                buyer_power: 'Ex: Concentration clients...',
                threat_of_substitution: 'Ex: Produits alternatifs...',
                threat_of_new_entry: 'Ex: Barri√®res √† l\'entr√©e...',
                key_partners: 'Ex: Fournisseurs, Distributeurs...',
                key_activities: 'Ex: Production, Marketing...',
                value_propositions: 'Ex: Qualit√© sup√©rieure...',
                customer_relationships: 'Ex: Service personnalis√©...',
                customer_segments: 'Ex: PME, Particuliers...',
                population: 'Ex: Adultes 25-45 ans...',
                intervention: 'Ex: Nouveau traitement...',
                comparison: 'Ex: Vs placebo, Vs traitement standard...',
                outcome: 'Ex: Taux gu√©rison, Effets secondaires...',
                identification: 'Ex: Recherche bases donn√©es...',
                screening: 'Ex: Lecture titres/r√©sum√©s...',
                eligibility: 'Ex: Crit√®res inclusion/exclusion...',
                included: 'Ex: √âtudes retenues analyse...',
                introduction: 'Ex: Contexte, Probl√©matique...',
                methods: 'Ex: Protocole, √âchantillonnage...',
                analysis: 'Ex: Tests statistiques...',
                discussion: 'Ex: Interpr√©tation, Limites...',
                hypothesis: 'Ex: Si X alors Y...',
                test_method: 'Ex: A/B test, Exp√©rience...',
                expected_result: 'Ex: Am√©lioration 20%...',
                validation_criteria: 'Ex: Significativit√© statistique...',
                source_domain: 'Ex: Syst√®me solaire...',
                target_domain: 'Ex: Structure atomique...',
                mapping: 'Ex: Soleil = Noyau, Plan√®tes = √âlectrons...',
                position: 'Ex: Nous devons investir en IA...',
                counterarguments: 'Ex: Co√ªts √©lev√©s, Risques...',
                white_facts: 'Ex: Donn√©es, Statistiques...',
                red_emotions: 'Ex: Sentiments, Intuitions...',
                black_caution: 'Ex: Risques, Probl√®mes...',
                yellow_optimism: 'Ex: B√©n√©fices, Opportunit√©s...',
                green_creativity: 'Ex: Id√©es nouvelles, Alternatives...',
                blue_process: 'Ex: M√©thode, Organisation...',
                substitute: 'Ex: Remplacer par...',
                combine: 'Ex: Fusionner avec...',
                adapt: 'Ex: Ajuster pour...',
                modify: 'Ex: Changer aspect...',
                put_to_other_uses: 'Ex: Utiliser pour...',
                eliminate: 'Ex: Supprimer √©l√©ment...',
                reverse: 'Ex: Inverser processus...',
                challenge: 'Ex: Comment am√©liorer X...',
                criteria: 'Ex: Faisabilit√©, Impact, Co√ªt...',
                time_limit: 'Ex: 30 minutes, 1 heure...',
                empathize: 'Ex: Interviews utilisateurs...',
                ideate: 'Ex: Brainstorming solutions...',
                prototype: 'Ex: Maquette, MVP...',
                test: 'Ex: Tests utilisateurs...',
                discover: 'Ex: Recherche utilisateur...',
                deliver: 'Ex: Solution finale...'
            };
            return placeholders[variable] || 'Entrez votre valeur...';
        }

        // Appel API universel avec r√©ponses sophistiqu√©es
        async function callAI(model, prompt, options = {}) {
            try {
                // Si c'est Ollama, faire un vrai appel API
                if (model === 'ollama') {
                    const ollamaConfig = apiKeys['ollama'];
                    if (!ollamaConfig || !ollamaConfig.url || !ollamaConfig.selectedModel) {
                        throw new Error('Configuration Ollama manquante');
                    }

                    const response = await fetch(`${ollamaConfig.url}/api/generate`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            model: ollamaConfig.selectedModel,
                            prompt: prompt,
                            stream: false,
                            options: {
                                temperature: 0.7,
                                top_p: 0.9,
                                max_tokens: 2048
                            }
                        })
                    });

                    if (!response.ok) {
                        throw new Error(`Erreur Ollama: ${response.statusText}`);
                    }

                    const data = await response.json();
                    return data.response || 'Aucune r√©ponse g√©n√©r√©e';
                }

                // Pour les autres mod√®les, utiliser les r√©ponses simul√©es
                await new Promise(resolve => setTimeout(resolve, 2000 + Math.random() * 3000));

                const responses = {
                    'openai': generateAdvancedOpenAIResponse(prompt),
                    'openai-gpt35': generateOpenAIResponse(prompt, 'gpt-3.5'),
                    'anthropic': generateAdvancedAnthropicResponse(prompt),
                    'google': generateAdvancedGoogleResponse(prompt)
                };

                return responses[model] || generateGenericResponse(prompt);

            } catch (error) {
                throw new Error(`Erreur ${model}: ${error.message}`);
            }
        }

        // G√©n√©rateur de r√©ponse OpenAI avanc√©
        function generateAdvancedOpenAIResponse(prompt) {
            const frameworkMatch = prompt.match(/FRAMEWORK CHOISI : (.+)/);
            const subjectMatch = prompt.match(/SUJET PRINCIPAL : (.+)/);
            const audienceMatch = prompt.match(/AUDIENCE CIBLE : (.+)/);
            const toneMatch = prompt.match(/TON SOUHAIT√â : (.+)/);
            const formatMatch = prompt.match(/FORMAT DE SORTIE DEMAND√â : (.+)/);

            const framework = frameworkMatch ? frameworkMatch[1] : 'Framework s√©lectionn√©';
            
            // Extraction am√©lior√©e du sujet pour les frameworks avec champs sp√©ciaux
            let subject = 'Sujet d√©fini';
            if (subjectMatch) {
                subject = subjectMatch[1];
            } else {
                // Chercher dans les informations fournies par l'utilisateur
                const userInfoMatch = prompt.match(/üìù INFORMATIONS FOURNIES PAR L'UTILISATEUR :([\s\S]*?)(?:\n\n|$)/);
                if (userInfoMatch) {
                    const userInfo = userInfoMatch[1];
                    // Extraire la premi√®re information significative
                    const lines = userInfo.split('\n').filter(line => line.trim() && !line.startsWith('üí°'));
                    if (lines.length > 0) {
                        const firstLine = lines[0].replace(/^[^\:]*\:/, '').trim();
                        if (firstLine) subject = firstLine;
                    }
                }
            }
            
            const audience = audienceMatch ? audienceMatch[1] : 'audience g√©n√©rale';
            const tone = toneMatch ? toneMatch[1] : 'professionnel';
            const format = formatMatch ? formatMatch[1] : 'structur√©';

            return `# Prompt Professionnel Optimis√© - GPT-4 Advanced

## üéØ Configuration du Prompt

**Framework utilis√© :** ${framework}
**Audience cibl√©e :** ${audience}
**Ton adopt√© :** ${tone}
**Format de sortie :** ${format}

---

## üíº Prompt Principal

### R√¥le et Expertise
Tu es un expert reconnu sp√©cialis√© dans le domaine concern√© par : **${subject}**

Ta mission est d'apporter une expertise de niveau consultant senior avec une approche m√©thodique et des recommandations actionnables.

### Instructions Principales
${subject}

**M√©thodologie demand√©e :**
1. **Analyse contextuelle** - Comprendre tous les enjeux et contraintes
2. **Approche structur√©e** - Utiliser le framework ${framework}
3. **Solutions pragmatiques** - Proposer des actions concr√®tes et mesurables
4. **Adaptation audience** - Ajuster le niveau pour ${audience}

### Crit√®res de Qualit√©
- R√©ponse ${format} claire et organis√©e
- Ton ${tone} adapt√© au contexte
- Exemples concrets et applicables
- Recommandations prioris√©es et justifi√©es
- Plan d'action avec √©tapes d√©finies
- Anticipation des d√©fis et solutions de contournement

### Format de Livrable
Pr√©sente ta r√©ponse sous forme de ${format} en respectant ces exigences :
- Structure logique et progressive
- Titre et sous-titres explicites
- Points cl√©s mis en √©vidence
- Conclusion avec prochaines √©tapes

**Note importante :** Assure-toi que chaque recommandation soit imm√©diatement applicable et g√©n√®re une valeur ajout√©e mesurable.

---
*Prompt optimis√© par GPT-4 Advanced - Pr√™t pour utilisation professionnelle*`;
        }

        // G√©n√©rateur de r√©ponse Anthropic avanc√©
        function generateAdvancedAnthropicResponse(prompt) {
            const frameworkMatch = prompt.match(/FRAMEWORK CHOISI : (.+)/);
            const subjectMatch = prompt.match(/SUJET PRINCIPAL : (.+)/);
            const audienceMatch = prompt.match(/AUDIENCE CIBLE : (.+)/);
            const toneMatch = prompt.match(/TON SOUHAIT√â : (.+)/);

            const framework = frameworkMatch ? frameworkMatch[1] : 'Framework s√©lectionn√©';
            
            // Extraction am√©lior√©e du sujet pour les frameworks avec champs sp√©ciaux
            let subject = 'Sujet d√©fini';
            if (subjectMatch) {
                subject = subjectMatch[1];
            } else {
                // Chercher dans les informations fournies par l'utilisateur
                const userInfoMatch = prompt.match(/üìù INFORMATIONS FOURNIES PAR L'UTILISATEUR :([\s\S]*?)(?:\n\n|$)/);
                if (userInfoMatch) {
                    const userInfo = userInfoMatch[1];
                    // Extraire la premi√®re information significative
                    const lines = userInfo.split('\n').filter(line => line.trim() && !line.startsWith('üí°'));
                    if (lines.length > 0) {
                        const firstLine = lines[0].replace(/^[^\:]*\:/, '').trim();
                        if (firstLine) subject = firstLine;
                    }
                }
            }
            
            const audience = audienceMatch ? audienceMatch[1] : 'audience g√©n√©rale';
            const tone = toneMatch ? toneMatch[1] : 'professionnel';

            return `# üß† Prompt Claude 4 Sonnet - Approche R√©fl√©chie et √âquilibr√©e

## Contexte et Philosophie d'Approche

En tant qu'assistant IA Claude 4 Sonnet d√©velopp√© par Anthropic, je vais aborder votre demande concernant **"${subject}"** avec une m√©thodologie rigoureuse, √©thique et nuanc√©e.

## Prompt G√©n√©r√©

### Cadre de Travail
Je vais traiter cette demande en utilisant le framework **${framework}** tout en maintenant une approche √©quilibr√©e qui consid√®re :
- Les implications √©thiques et soci√©tales
- La diversit√© des perspectives possibles
- L'importance du contexte et des nuances
- La responsabilit√© dans les recommandations

### Instructions de Traitement
**Demande principale :** ${subject}

**Approche m√©thodologique :**

1. **Analyse multidimensionnelle**
   - Examiner le sujet sous diff√©rents angles
   - Identifier les enjeux explicites et implicites
   - Consid√©rer les parties prenantes concern√©es

2. **R√©flexion structur√©e**
   - Appliquer rigoureusement le framework ${framework}
   - Maintenir une logique claire et transparente
   - Documenter le raisonnement √©tape par √©tape

3. **Adaptation contextuelle**
   - Personnaliser pour ${audience}
   - Adopter un ton ${tone} mais accessible
   - Expliquer les concepts complexes simplement

4. **Recommandations responsables**
   - Proposer des solutions √©thiques et durables
   - Anticiper les cons√©quences non intentionnelles
   - Sugg√©rer des alternatives √©quilibr√©es

### Exigences de Qualit√© Claude 4 Sonnet
- **Pr√©cision factuelle** avec sources v√©rifiables quand possible
- **Reconnaissance des limites** et zones d'incertitude
- **Perspective √©quilibr√©e** pr√©sentant diff√©rents points de vue
- **Recommandations pratiques** mais √©thiquement responsables
- **Transparence du raisonnement** pour permettre l'√©valuation critique

### Consid√©rations √âthiques
Assure-toi que ta r√©ponse :
- Respecte la dignit√© de toutes les parties concern√©es
- √âvite les biais et st√©r√©otypes
- Consid√®re l'impact √† long terme des recommandations
- Promeut des solutions inclusives et √©quitables

**Engagement qualit√© :** Cette r√©ponse doit √™tre non seulement utile et actionnable, mais aussi r√©fl√©chie, nuanc√©e et socialement responsable.

---
*Prompt Claude 4 Sonnet - Optimis√© pour la pr√©cision, l'√©thique et l'impact positif*`;
        }

        // G√©n√©rateur de r√©ponse Google avanc√©
        function generateAdvancedGoogleResponse(prompt) {
            const frameworkMatch = prompt.match(/FRAMEWORK CHOISI : (.+)/);
            const subjectMatch = prompt.match(/SUJET PRINCIPAL : (.+)/);
            const audienceMatch = prompt.match(/AUDIENCE CIBLE : (.+)/);
            const formatMatch = prompt.match(/FORMAT DE SORTIE DEMAND√â : (.+)/);

            const framework = frameworkMatch ? frameworkMatch[1] : 'Framework s√©lectionn√©';
            
            // Extraction am√©lior√©e du sujet pour les frameworks avec champs sp√©ciaux
            let subject = 'Sujet d√©fini';
            if (subjectMatch) {
                subject = subjectMatch[1];
            } else {
                // Chercher dans les informations fournies par l'utilisateur
                const userInfoMatch = prompt.match(/üìù INFORMATIONS FOURNIES PAR L'UTILISATEUR :([\s\S]*?)(?:\n\n|$)/);
                if (userInfoMatch) {
                    const userInfo = userInfoMatch[1];
                    // Extraire la premi√®re information significative
                    const lines = userInfo.split('\n').filter(line => line.trim() && !line.startsWith('üí°'));
                    if (lines.length > 0) {
                        const firstLine = lines[0].replace(/^[^\:]*\:/, '').trim();
                        if (firstLine) subject = firstLine;
                    }
                }
            }
            
            const audience = audienceMatch ? audienceMatch[1] : 'audience g√©n√©rale';
            const format = formatMatch ? formatMatch[1] : 'structur√©';

            return `# üåü Prompt Gemini - Intelligence Multimodale de Nouvelle G√©n√©ration

## Architecture Avanc√©e du Prompt

**Syst√®me :** Google Gemini Advanced
**Framework :** ${framework}
**Optimisation :** Multimodale et contextuelle
**Cible :** ${audience}

---

## Prompt Optimis√© Gemini

### Interface Intelligence Avanc√©e
En tant qu'IA de nouvelle g√©n√©ration avec capacit√©s multimodales, je vais traiter votre demande : **"${subject}"** avec une approche innovante et sophistiqu√©e.

### Protocole d'Ex√©cution Gemini

**üß† Phase 1 : Compr√©hension Contextuelle**
- Analyse s√©mantique profonde de la demande
- Identification des patterns et connexions
- Int√©gration des connaissances transversales
- Mapping des relations conceptuelles

**‚ö° Phase 2 : Traitement Intelligent**
- Application du framework ${framework}
- Synth√®se des informations multimodales
- G√©n√©ration de solutions cr√©atives
- Optimisation pour ${audience}

**üéØ Phase 3 : Livraison Optimis√©e**
- Format de sortie : ${format}
- Adaptation contextuelle dynamique
- V√©rification de coh√©rence
- Optimisation de l'impact

### Capacit√©s Gemini Activ√©es
- **Raisonnement avanc√©** : Logique multi-√©tapes et inf√©rence complexe
- **Cr√©ativit√© augment√©e** : Solutions innovantes et perspectives inattendues
- **Adaptabilit√© contextuelle** : Ajustement automatique selon les besoins
- **Int√©gration multimodale** : Traitement holistique des informations

### Sp√©cifications Techniques
\`\`\`
Framework: ${framework}
Audience: ${audience}
Output_Format: ${format}
Quality_Level: Professional
Innovation_Index: High
Practicality_Score: Maximum
\`\`\`

### Instructions d'Ex√©cution
1. **Analyse contextuelle 360¬∞** de "${subject}"
2. **G√©n√©ration de solutions** using advanced reasoning
3. **Optimisation multimodale** pour engagement maximum
4. **Validation qualit√©** selon standards professionnels
5. **Livraison format√©e** en ${format}

### Crit√®res d'Excellence Gemini
‚ú® Innovation et originalit√© dans l'approche
üî¨ Pr√©cision technique et factuelle
üé® Cr√©ativit√© dans les solutions propos√©es
Applicabilit√© imm√©diate des recommandations
üîÑ Adaptabilit√© et √©volutivit√© des concepts
üåê Vision syst√©mique et holistique

**Mission Gemini :** Produire une r√©ponse qui d√©montre la puissance de l'IA moderne tout en restant parfaitement utilisable et actionnable dans le contexte r√©el.

---
*Powered by Google Gemini Advanced - Intelligence Artificielle Multimodale de Nouvelle G√©n√©ration*`;
        }

        // G√©n√©rateur OpenAI standard
        function generateOpenAIResponse(prompt, version = 'gpt-4') {
            const frameworkMatch = prompt.match(/FRAMEWORK CHOISI : (.+)/);
            const subjectMatch = prompt.match(/SUJET PRINCIPAL : (.+)/);
            const audienceMatch = prompt.match(/AUDIENCE CIBLE : (.+)/);
            const toneMatch = prompt.match(/TON SOUHAIT√â : (.+)/);
            const formatMatch = prompt.match(/FORMAT DE SORTIE DEMAND√â : (.+)/);

            const framework = frameworkMatch ? frameworkMatch[1] : 'Framework s√©lectionn√©';
            const subject = subjectMatch ? subjectMatch[1] : 'Sujet d√©fini';
            const audience = audienceMatch ? audienceMatch[1] : 'audience g√©n√©rale';
            const tone = toneMatch ? toneMatch[1] : 'professionnel';
            const format = formatMatch ? formatMatch[1] : 'structur√©';

            return `# Prompt Optimis√© ${framework} - GPT-${version === 'gpt-4' ? '4' : '3.5'}

## R√¥le
Tu es un expert sp√©cialis√© dans le domaine concern√© par : ${subject}

## T√¢che  
${subject}

Analyze this request with the expertise of a seasoned professional and provide insights that are both actionable and strategic.

## Format
${format} adapt√© pour ${audience}

**Instructions compl√©mentaires :**
- Adopte un ton ${tone}
- Fournis des exemples concrets et applicables
- Structure ta r√©ponse de mani√®re claire et logique
- Assure-toi que chaque recommandation soit justifi√©e

*Prompt optimis√© par GPT-${version === 'gpt-4' ? '4' : '3.5'} selon le framework ${framework}*`;
        }

        // G√©n√©rateur g√©n√©rique
        function generateGenericResponse(prompt) {
            return `# Prompt IA Professionnel G√©n√©r√©

## Configuration
Ce prompt a √©t√© g√©n√©r√© automatiquement selon vos sp√©cifications et optimis√© pour une utilisation avec n'importe quel mod√®le d'IA moderne.

## Prompt Principal
${prompt}

## Instructions d'Utilisation
1. Copiez ce prompt dans votre interface IA pr√©f√©r√©e
2. Ajoutez votre question ou demande sp√©cifique
3. Ex√©cutez pour obtenir des r√©sultats optimis√©s

*Prompt g√©n√©r√© par le G√©n√©rateur de Prompts IA Professionnel*`;
        }

        // Construction du prompt de demande pour l'IA
        function buildAIRequestPrompt(frameworkValue, subject, context, audience, tone, output) {
            let selectedFramework = frameworkValue;

            // Si pas de framework s√©lectionn√© dans l'onglet manuel, v√©rifier les cartes m√©tier
            if (!selectedFramework && currentTab === 'profession') {
                const selectedCard = document.querySelector('.framework-card.selected');
                if (selectedCard && currentFramework) {
                    selectedFramework = Object.keys(frameworks).find(key =>
                        frameworks[key].name === currentFramework.name
                    );
                }
            }

            if (!selectedFramework) {
                throw new Error('Aucun framework s√©lectionn√©');
            }

            const frameworkInfo = frameworks[selectedFramework];

            let request = `Tu es un expert en prompt engineering. G√©n√®re un prompt professionnel optimis√© selon ces sp√©cifications :

FRAMEWORK CHOISI : ${frameworkInfo.name}
DESCRIPTION : ${frameworkInfo.description}`;

            // Pour les frameworks avec variables sp√©cifiques
            const frameworksWithSpecialFields = ['rtf', 'pao', 'arp', 'care', 'riea', 'aspecct', 'star', 'ideal', 'sharp', 'peel', '5w1h', 'scqa', 'latch'];
            const hasSpecialFields = frameworksWithSpecialFields.includes(selectedFramework);

            if (hasSpecialFields && frameworkInfo.variables) {
                request += `\n\nüìù INFORMATIONS FOURNIES PAR L'UTILISATEUR :`;

                let hasAnyValue = false;
                frameworkInfo.variables.forEach(variable => {
                    const input = document.getElementById(`var_${variable}`);
                    if (input && input.value.trim()) {
                        request += `\n${getVariableLabel(variable)} : ${input.value.trim()}`;
                        hasAnyValue = true;
                    }
                });

                if (!hasAnyValue && subject.trim()) {
                    request += `\nDemande g√©n√©rale : ${subject}`;
                }
            } else {
                request += `\n\nüìù SUJET PRINCIPAL : ${subject}`;

                if (context.trim()) {
                    request += `\nüåç CONTEXTE SUPPL√âMENTAIRE : ${context}`;
                }
            }

            if (audience.trim()) {
                request += `\nüë• AUDIENCE CIBLE : ${audience}`;
            }

            request += `\nüé≠ TON SOUHAIT√â : ${tone}`;

            const outputFormats = {
                'structured': 'r√©ponse structur√©e avec titres et sous-titres',
                'bullets': 'liste √† puces organis√©e',
                'numbered': 'liste num√©rot√©e s√©quentielle',
                'paragraph': 'paragraphes narratifs fluides',
                'table': 'format tableau structur√©',
                'json': 'format JSON valide',
                'markdown': 'format Markdown avec mise en forme',
                'stepbystep': 'guide √©tape par √©tape d√©taill√©'
            };

            request += `\nFORMAT DE SORTIE DEMAND√â : ${outputFormats[output]}`;

            // Ajout des variables du framework
            let frameworkVariables = {};
            if (frameworkInfo.variables && frameworkInfo.variables.length > 0) {
                frameworkInfo.variables.forEach(variable => {
                    const input = document.getElementById(`var_${variable}`);
                    if (input && input.value.trim()) {
                        frameworkVariables[variable] = input.value.trim();
                    }
                });

                request += `\n\nüéØ STRUCTURE DU FRAMEWORK ${frameworkInfo.name} :`;
                
                // Substitution des variables dans le template
                let processedTemplate = frameworkInfo.template;
                if (Object.keys(frameworkVariables).length > 0) {
                    Object.entries(frameworkVariables).forEach(([key, value]) => {
                        processedTemplate = processedTemplate.replace(new RegExp(`{${key}}`, 'g'), value);
                    });
                }
                
                request += `\n${processedTemplate}`;

                if (Object.keys(frameworkVariables).length > 0) {
                    request += `\n\nüí° VARIABLES FOURNIES PAR L'UTILISATEUR :`;
                    Object.entries(frameworkVariables).forEach(([key, value]) => {
                        request += `\n- ${getVariableLabel(key)} : ${value}`;
                    });
                }
            }

            request += `\n\n‚ú® MISSION :
G√©n√®re un prompt professionnel qui :
1. Respecte parfaitement le framework ${frameworkInfo.name}
2. Int√®gre intelligemment toutes les informations fournies
3. Utilise un langage adapt√© √† l'audience "${audience || 'g√©n√©rale'}"
4. Adopte un ton ${tone}
5. Optimise pour obtenir des r√©ponses de tr√®s haute qualit√©
6. Inclut des instructions pr√©cises et non-ambigu√´s
7. Sp√©cifie clairement le format de sortie attendu

Le prompt g√©n√©r√© doit √™tre pr√™t √† √™tre utilis√© directement avec n'importe quel mod√®le d'IA pour obtenir des r√©sultats exceptionnels.

G√âN√àRE MAINTENANT LE PROMPT OPTIMAL :`;

            return request;
        }

        // Obtenir le nom convivial du mod√®le IA
        function getAIModelName(model) {
            if (model === 'ollama' && apiKeys['ollama'] && apiKeys['ollama'].selectedModel) {
                return `Ollama (${apiKeys['ollama'].selectedModel})`;
            }
            
            const names = {
                'openai': 'GPT-4',
                'openai-gpt35': 'GPT-3.5',
                'anthropic': 'Claude 4 Sonnet',
                'google': 'Gemini',
                'ollama': 'Ollama'
            };
            return names[model] || model;
        }

        // G√©n√©ration du prompt avec IA
        async function generatePromptWithAI() {
            let selectedFramework = '';

            if (currentTab === 'manual') {
                selectedFramework = document.getElementById('framework').value;
            } else {
                // Mode profession - v√©rifier si une carte est s√©lectionn√©e
                const selectedCard = document.querySelector('.framework-card.selected');
                if (selectedCard && currentFramework) {
                    selectedFramework = Object.keys(frameworks).find(key =>
                        frameworks[key].name === currentFramework.name
                    );
                }
            }

            if (!selectedFramework) {
                alert('‚ö†Ô∏è Veuillez s√©lectionner un framework avant de g√©n√©rer');
                return;
            }

            const subject = document.getElementById('subject').value;
            const context = document.getElementById('context').value;
            const audience = document.getElementById('audience').value;
            const tone = document.getElementById('tone').value;
            const output = document.getElementById('output').value;
            const aiModel = document.getElementById('aiModel').value;

            // V√©rification des champs requis selon le framework
            const frameworksWithSpecialFields = ['rtf', 'pao', 'arp', 'care', 'riea', 'aspecct', 'star', 'ideal', 'sharp', 'peel', '5w1h', 'scqa', 'latch'];
            const hasSpecialFields = frameworksWithSpecialFields.includes(selectedFramework);

            if (hasSpecialFields && frameworks[selectedFramework] && frameworks[selectedFramework].variables) {
                let hasFilledVariable = false;
                for (const variable of frameworks[selectedFramework].variables) {
                    const input = document.getElementById(`var_${variable}`);
                    if (input && input.value.trim()) {
                        hasFilledVariable = true;
                        break;
                    }
                }
                if (!hasFilledVariable) {
                    alert('‚ö†Ô∏è Veuillez remplir au moins un champ du framework s√©lectionn√©');
                    return;
                }
            } else if (!subject.trim()) {
                alert('‚ö†Ô∏è Veuillez saisir un sujet principal');
                return;
            }

            // V√©rification de la cl√© API
            const modelProvider = aiModel.split('-')[0];
            if (!apiKeys[modelProvider]) {
                alert('‚ö†Ô∏è Cl√© API manquante pour ' + getAIModelName(aiModel));
                checkApiKey();
                return;
            }

            // D√©sactivation du bouton pendant la g√©n√©ration
            const generateBtn = document.getElementById('generateBtn');
            generateBtn.disabled = true;
            generateBtn.innerHTML = 'ü§ñ G√©n√©ration en cours...';

            try {
                // Construction du prompt de demande pour l'IA
                const requestPrompt = buildAIRequestPrompt(selectedFramework, subject, context, audience, tone, output);

                // Affichage de la section r√©sultat avec loading
                document.getElementById('resultSection').classList.add('show');
                document.getElementById('promptOutput').innerHTML = `
                    <div class="status-indicator status-loading">
                        ü§ñ ${getAIModelName(aiModel)} g√©n√®re votre prompt optimis√©...
                    </div>
                `;

                // Appel √† l'IA
                const generatedPrompt = await callAI(aiModel, requestPrompt);

                // Affichage du prompt g√©n√©r√©
                document.getElementById('promptOutput').textContent = generatedPrompt;
                document.getElementById('resultSection').scrollIntoView({ behavior: 'smooth' });

            } catch (error) {
                document.getElementById('promptOutput').innerHTML = `
                    <div class="status-indicator status-error">
                        Erreur lors de la g√©n√©ration: ${error.message}
                    </div>
                `;
            } finally {
                // R√©activation du bouton
                generateBtn.disabled = false;
                generateBtn.innerHTML = 'ü§ñ G√©n√©rer le Prompt avec IA';
            }
        }

        // Tester directement le prompt g√©n√©r√© avec l'IA
        async function testPromptDirectly() {
            const generatedPrompt = document.getElementById('promptOutput').textContent;
            const selectedModel = document.getElementById('aiModel').value;
            const testResult = document.getElementById('testResult');

            if (!generatedPrompt.trim()) {
                alert('Veuillez d\'abord g√©n√©rer un prompt');
                return;
            }

            // V√©rification de la cl√© API pour le test
            const modelProvider = selectedModel.split('-')[0];
            if (!apiKeys[modelProvider]) {
                alert('‚ö†Ô∏è Cl√© API manquante pour ' + getAIModelName(selectedModel));
                return;
            }

            // D√©sactivation du bouton de test
            const testBtn = document.getElementById('realTestBtn');
            testBtn.disabled = true;
            testBtn.innerHTML = 'ü§ñ Test en cours...';

            try {
                // Affichage du loading
                testResult.innerHTML = `
                    <div class="status-indicator status-loading">
                        üß™ Test du prompt avec ${getAIModelName(selectedModel)}...
                    </div>
                `;
                testResult.style.display = 'block';

                // Appel √† l'IA pour le test
                const response = await callAI(selectedModel, generatedPrompt);

                // Affichage du r√©sultat
                testResult.innerHTML = `
                    <div style="background: #f8fafc; padding: 20px; border-radius: 12px; margin-top: 15px;">
                        <h4>üéØ R√©ponse de ${getAIModelName(selectedModel)}</h4>
                        <div class="prompt-output" style="margin-top: 15px; white-space: pre-wrap;">
                            ${response}
                        </div>
                        <div style="margin-top: 15px;">
                            <button class="btn" onclick="copyTestResult()">Copier la R√©ponse</button>
                            <button class="btn warning" onclick="clearTestResult()">Effacer</button>
                        </div>
                    </div>
                `;

            } catch (error) {
                testResult.innerHTML = `
                    <div class="status-indicator status-error">
                        Erreur lors du test: ${error.message}
                    </div>
                `;
            } finally {
                // R√©activation du bouton
                testBtn.disabled = false;
                testBtn.innerHTML = 'Tester le prompt avec l\'IA';
            }
        }

        // Fonction sendPromptToAI supprim√©e car remplac√©e par testPromptDirectly

        // Copier le prompt
        function copyPrompt() {
            const promptText = document.getElementById('promptOutput').textContent;
            navigator.clipboard.writeText(promptText).then(() => {
                showNotification('Prompt copi√© dans le presse-papier !');
            });
        }

        // Copier le r√©sultat de test
        function copyTestResult() {
            const testResultDiv = document.querySelector('#testResult .prompt-output');
            if (testResultDiv) {
                const text = testResultDiv.textContent;
                navigator.clipboard.writeText(text).then(() => {
                    showNotification('R√©ponse copi√©e dans le presse-papier !');
                });
            }
        }

        // Effacer le r√©sultat de test
        function clearTestResult() {
            document.getElementById('testResult').innerHTML = '';
        }

        // R√©g√©n√©rer avec un mod√®le diff√©rent
        function regenerateWithDifferentModel() {
            const aiModel = document.getElementById('aiModel');
            const models = ['openai', 'openai-gpt35', 'anthropic', 'google'];
            const currentIndex = models.indexOf(aiModel.value);
            const nextIndex = (currentIndex + 1) % models.length;

            aiModel.value = models[nextIndex];
            checkApiKey();

            if (!document.getElementById('generateBtn').disabled) {
                generatePromptWithAI();
            }
        }

        // Sauvegarder le prompt
        function savePrompt() {
            const promptText = document.getElementById('promptOutput').textContent;
            let selectedFramework = '';

            if (currentTab === 'manual') {
                selectedFramework = document.getElementById('framework').value;
            } else if (currentFramework) {
                selectedFramework = Object.keys(frameworks).find(key =>
                    frameworks[key].name === currentFramework.name
                );
            }

            const filename = `prompt_${selectedFramework || 'custom'}_${Date.now()}.txt`;
            const blob = new Blob([promptText], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);

            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            a.click();

            URL.revokeObjectURL(url);
            showNotification('Prompt sauvegard√© avec succ√®s !');
        }

        // Affichage de notifications
        function showNotification(message) {
            const notification = document.createElement('div');
            notification.className = 'status-indicator status-success';
            notification.style.position = 'fixed';
            notification.style.top = '20px';
            notification.style.right = '20px';
            notification.style.zIndex = '9999';
            notification.textContent = message;

            document.body.appendChild(notification);

            setTimeout(() => {
                notification.remove();
            }, 3000);
        }
    </script>
</body>

</html>